<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Frases CCK</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/citas_slide.css">
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script type="text/javascript" src="js/galeria.js"></script>

    <script>
        var t, actual;

        function select(i) {
            actual = i;

            $("nav a")
                .removeClass("on off")
                .addClass(function (j) {
                    return (j === i) ? "on" : "off";
                });

            $("#persona").html(galeria[i].persona);
            $("#frase").html(galeria[i].frase);
            $("#foto").attr("src", galeria[i].foto);

            clearTimeout(t);
            t = setTimeout(function () {
                select((i + 1) % galeria.length);
            }, 2000);
        }

        function generar_selector() { // regenera la botonera
            var selector = $("#selector");

            selector.html("");

            galeria.forEach(function (elem, i) {
                selector.append("<li><a onClick='select(" + i + ")'></a></li>");
            });
        }

        $(function () {
            generar_selector();

            $("#editar").on("click", function () {
                clearTimeout(t);

                $("#persona_d").html(galeria[actual].persona);
                $("#frase_d").html(galeria[actual].frase);
                $("#foto_d").html(galeria[actual].foto);

                $("#datos").css("display", "block");
            })


            $("#nuevo").on("click", function () {
                $("#datos").css("display", "none");

                actual = galeria.push({
                    persona: $("#persona_d").html(),
                    frase: $("#frase_d").html(),
                    foto: $("#foto_d").html()
                }) - 1;

                generar_selector();

                select(actual);
            })

            $("#guardar").on("click", function () {
                $("#datos").css("display", "none");

                // Guardar lo editado:
                galeria[actual].persona = $("#persona_d").html();
                galeria[actual].frase = $("#frase_d").html();
                galeria[actual].foto = $("#foto_d").html();

                generar_selector();
                select(actual);
            });

            $('#borrar').on('click', function () {
                $("#datos").css("display", "none");

                // Saca el elemento seleccionado del array
                galeria.splice(actual, 1);

                // asegura que se siga el orden de mostrar el siguiente al sacar una frase
                if (actual === 0 || actual === galeria.length) actual = 0;

                generar_selector();
                select(actual);
            });

            select(0);
        });
    </script>
    <style>
        .container .panel-footer {
            margin-top: 20px;
        }

        @media (orientation: landscape) {
            .seccion {
                display: grid;
                grid-template-columns: 1fr 3fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="contenido">
            <nav class="navbar navbar-inverse ">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#miMenu">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="index.html">CCKevin</a>
                    </div>
                    <div class="collapse navbar-collapse" id="miMenu">
                        <ul class="nav navbar-nav">
                            <li><a href="index.html">INICIO</a></li>
                            <li><a href="ejercicio_puzzle.html">PUZZLE</a></li>
                            <li><a href="calc_cck.html">CALCCK</a></li>
                            <li class="active"><a href="frases.html">FRASES</a></li>
                            <li><a href="../index.html#contacto">CONTACTAR</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            <nav id="nav">
                <ul id="selector">
                </ul>
            </nav>
            <section id="caja">
                <img id="foto" alt="" />
                <div class="textos">
                    <p id="frase"></p>
                    <p id="persona"></p>
                </div>
            </section>
            <div class="editar" id="editar">
                <img src="images/carat-d-white.svg" alt="" />
            </div>
            <section id="datos">
                <div contentEditable="true" id="persona_d"></div>
                <div contentEditable="true" id="frase_d"></div>
                <div contentEditable="true" id="foto_d"></div>
                <div id="botones">
                    <ul>
                        <li><img src="images/edit-black.svg" alt="" id="guardar" /></li>
                        <li><img src="images/plus-black.svg" alt="" id="nuevo" /></li>
                        <li><img src="images/delete-black.svg" alt="" id="borrar" /></li>
                    </ul>
                </div>
            </section>
            <footer class="panel-footer">
                <p class="pies"><small>En Twitter: <a href="https://twitter.com/cckev1n"
                            class="enlace">@cckev1n</a></small>
                </p>
                <p class="pies"><small>Ir a mi sitio principal: <a href="../index.html" class="enlace">CCKevin en
                            Neocities</a></small></p>
                <p class="pies">&copy;2019</p>
            </footer>
        </div>

    </div>

</body>

</html>